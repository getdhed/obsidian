# üèó API –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)

–û—á–µ–Ω—å —á–∞—Å—Ç—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤ Go ‚Äî –¥–µ–ª–∞—Ç—å API –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

type API struct {  
	router *http.ServeMux // –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π router  
}

–∏–ª–∏

type API struct {  
	router Router  
}

### –ü–æ—á–µ–º—É —Ç–∞–∫ –¥–µ–ª–∞—é—Ç?

–ü–æ—Ç–æ–º—É —á—Ç–æ API ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π:

- —Ö—Ä–∞–Ω–∏—Ç —Ä–æ—É—Ç–µ—Ä
    
- —Ö—Ä–∞–Ω–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (service, repo, config)
    
- —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç endpoints
    
- –ø–æ–¥–∫–ª—é—á–∞–µ—Ç middleware
    

---

## –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä API

func New(router Router, svc UserService) *API {  
	return &API{  
		router: router,  
		svc:    svc,  
	}  
}

–ò–¥–µ—è:

> API ‚Äî —ç—Ç–æ —Ç–æ—á–∫–∞ —Å–±–æ—Ä–∫–∏ HTTP —Å–ª–æ—è.

---

## –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ (Endpoints)

–û–±—ã—á–Ω–æ –¥–µ–ª–∞—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥:

func (api *API) Endpoints() {  
	api.router.HandleFunc("/api/v1/users", api.createUser)  
	api.router.HandleFunc("/api/v1/users", api.listUsers)  
}

–≠—Ç–æ —É–¥–æ–±–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ:

- –º–∞—Ä—à—Ä—É—Ç—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã
    
- –≤–∏–¥–Ω–æ –≤—Å—é ‚Äú–∫–∞—Ä—Ç—É API‚Äù
    
- –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
    

---

# üß≠ –†–æ—É—Ç–µ—Ä ‚Äî —ç—Ç–æ ‚Äú–∫–∞—Ä—Ç–∞ API‚Äù

–û—á–µ–Ω—å –≤–∞–∂–Ω–∞—è –º—ã—Å–ª—å:

> –†–æ—É—Ç–µ—Ä ‚Äî —ç—Ç–æ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è —Ç–≤–æ–µ–≥–æ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

–•–æ—Ä–æ—à–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å:

- —á–∏—Ç–∞–µ–º–æ–π
    
- —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–π
    
- –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π (`/api/v1`)
    
- –±–µ–∑ —Ö–∞–æ—Å–∞
    

---

## –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤

–õ—É—á—à–µ –ø–∏—Å–∞—Ç—å –Ω–µ —Ç–∞–∫:

router.HandleFunc("/api/v1/users", ...)  
router.HandleFunc("/api/v1/users/{id}", ...)  
router.HandleFunc("/api/v1/orders", ...)

–ê –ª–æ–≥–∏—á–µ—Å–∫–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å:

- `/api/v1`
    
    - `/users`
        
    - `/orders`
        
    - `/docs`
        

–≠—Ç–æ –¥–µ–ª–∞–µ—Ç API –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–º.

---

# ‚ùó –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞–µ—Ç 404 –ø—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º endpoint

–ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç—ã—Ö –ø—Ä–∏—á–∏–Ω.

## 1Ô∏è‚É£ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å

`/api//v1/docs`  
–∏  
`/api/v1/docs`

‚Äî —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –ø—É—Ç–∏.

–î–≤–æ–π–Ω–æ–π —Å–ª—ç—à (`//`) –º–æ–∂–µ—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –µ—Å–ª–∏ —Ç—ã:

- –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É–µ—à—å —Å—Ç—Ä–æ–∫–∏
    
- –¥–æ–±–∞–≤–ª—è–µ—à—å `/` –≤—Ä—É—á–Ω—É—é
    
- –∏—Å–ø–æ–ª—å–∑—É–µ—à—å basePath + "/v1"
    

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ä–æ—É—Ç–µ—Ä–æ–≤ –Ω–µ ‚Äú–Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç‚Äù –ø—É—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

## 2Ô∏è‚É£ –ú–µ—Ç–æ–¥ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç

–ï—Å–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:

GET /api/v1/docs

–∞ —Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å:

POST /api/v1/docs

—Ç–æ –±—É–¥–µ—Ç:

- –ª–∏–±–æ 404
    
- –ª–∏–±–æ 405 (Method Not Allowed)
    

---

## 3Ô∏è‚É£ Middleware —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –Ω–æ —Ä–æ—É—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω

Middleware –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –î–û –ø–æ–∏—Å–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞.

–ü–æ—ç—Ç–æ–º—É —Ç—ã –º–æ–∂–µ—à—å –≤–∏–¥–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:

start: GET /api/v1/docs  
end: GET /api/v1/docs

–ù–æ –µ—Å–ª–∏ —Ä–æ—É—Ç –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω ‚Äî –±—É–¥–µ—Ç 404.

---

# üß± Handler –∫–∞–∫ –º–µ—Ç–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–í–º–µ—Å—Ç–æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ª—É—á—à–µ –¥–µ–ª–∞—Ç—å –º–µ—Ç–æ–¥—ã:

func (api *API) listUsers(w http.ResponseWriter, r *http.Request) {  
	users, err := api.svc.List()  
	...  
}

–ü–æ—á–µ–º—É —ç—Ç–æ –ª—É—á—à–µ:

- –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º
    
- –Ω–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    
- –ª–µ–≥—á–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
    
- —á–∏—â–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
    

---

# üß© Middleware ‚Äî —ç—Ç–æ –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ handler

Middleware ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤–∏–¥–∞:

func(next http.Handler) http.Handler

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ:

Request  
  ‚Üì  
LoggingMiddleware  
  ‚Üì  
AuthMiddleware  
  ‚Üì  
Handler

–ï—Å–ª–∏ middleware –Ω–µ –≤—ã–∑–æ–≤–µ—Ç:

next.ServeHTTP(w, r)

–∑–∞–ø—Ä–æ—Å –¥–∞–ª—å—à–µ –Ω–µ –ø–æ–π–¥—ë—Ç.

---

# üîÅ –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞)

1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å
    
2. –ó–∞–ø—Ä–æ—Å –ø–æ–ø–∞–¥–∞–µ—Ç –≤ router
    
3. Router –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç handler –≤ middleware
    
4. Middleware –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è
    
5. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è handler
    
6. Handler –≤—ã–∑—ã–≤–∞–µ—Ç service
    
7. Service –≤—ã–∑—ã–≤–∞–µ—Ç repo
    
8. –û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ
    

---

# üß† –í–∞–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –º—ã—Å–ª—å

API —Å–ª–æ–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:

- —Ç–æ–Ω–∫–∏–º
    
- –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–º
    
- –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–º
    
- –±–µ–∑ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
    
- –±–µ–∑ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î
    

---

# üö® –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ API

- ‚ùå –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–º–µ—Å—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
    
- ‚ùå –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ handler
    
- ‚ùå –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    
- ‚ùå —Ä–∞–∑–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫
    
- ‚ùå –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ timeout‚Äô–æ–≤
    
- ‚ùå —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ API
    
- ‚ùå —Å—Ç—Ä–æ–∫–æ–≤–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –ø—É—Ç–µ–π —Å –ª–∏—à–Ω–∏–º–∏ `/`
    

---

# üß™ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω

–•–æ—Ä–æ—à–∏–π API –≤ Go –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

- `type API struct`
    
- `func New(...)`
    
- `func (api *API) Endpoints()`
    
- `func (api *API) Router() http.Handler`
    
- –º–µ—Ç–æ–¥—ã-—Ö–µ–Ω–¥–ª–µ—Ä—ã –∫–∞–∫ –º–µ—Ç–æ–¥—ã —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
    
- middleware –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
    

---

# üß≠ –ò—Ç–æ–≥–æ–≤–∞—è –º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å

API ‚Äî —ç—Ç–æ:

> –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —Å–ª–æ—è + –∞–¥–∞–ø—Ç–µ—Ä –∫ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ.

–ù–µ –º–æ–∑–≥.  
–ù–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.  
–ù–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞.

–ê –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ —Å–∏—Å—Ç–µ–º—ã.