# üèó API –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)

–û—á–µ–Ω—å —á–∞—Å—Ç—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –≤ Go ‚Äî –¥–µ–ª–∞—Ç—å API –∫–∞–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

type API struct {  
	router *http.ServeMux // –∏–ª–∏ –¥—Ä—É–≥–æ–π [[Router]]  
	svc    UserService  
}

### –ü–æ—á–µ–º—É —Ç–∞–∫ –¥–µ–ª–∞—é—Ç?

–ü–æ—Ç–æ–º—É —á—Ç–æ API ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π:

- —Ö—Ä–∞–Ω–∏—Ç —Ä–æ—É—Ç–µ—Ä ([[Router]])
    
- —Ö—Ä–∞–Ω–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ([[Dependency Injection]])
    
- —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç endpoints
    
- –ø–æ–¥–∫–ª—é—á–∞–µ—Ç [[Middleware]]
    

---

## –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä API

func New(router *http.ServeMux, svc UserService) *API {  
	return &API{  
		router: router,  
		svc:    svc,  
	}  
}

–ò–¥–µ—è:

> API ‚Äî —ç—Ç–æ —Ç–æ—á–∫–∞ —Å–±–æ—Ä–∫–∏ [[HTTP]] —Å–ª–æ—è.

---

## –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ (Endpoints)

–û–±—ã—á–Ω–æ –¥–µ–ª–∞—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥:

func (api *API) Endpoints() {  
	api.router.HandleFunc("POST /api/v1/users", api.createUser)  
	api.router.HandleFunc("GET /api/v1/users", api.listUsers)  
}

–≠—Ç–æ:

- –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
    
- –∫–∞—Ä—Ç–∞ API
    
- —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Ä—Å–∏–∏ (`/v1`) ‚Äî —Å–º. [[Versioning]]
    

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[REST API]], [[Router]], [[Status Code]]

---

# üß≠ –†–æ—É—Ç–µ—Ä ‚Äî —ç—Ç–æ ‚Äú–∫–∞—Ä—Ç–∞ API‚Äù

–û—á–µ–Ω—å –≤–∞–∂–Ω–∞—è –º—ã—Å–ª—å:

> [[Router]] ‚Äî —ç—Ç–æ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è —Ç–≤–æ–µ–≥–æ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞.

–•–æ—Ä–æ—à–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å:

- —á–∏—Ç–∞–µ–º–æ–π
    
- —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–æ–π
    
- –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π (`/api/v1`)
    
- –±–µ–∑ —Ö–∞–æ—Å–∞
    

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[REST API]], [[Clean Architecture]]

---

# ‚ùó –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞–µ—Ç 404 –ø—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º endpoint

## 1Ô∏è‚É£ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å

`/api//v1/docs`  
–∏  
`/api/v1/docs`

‚Äî —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –ø—É—Ç–∏.

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ [[Router]] –Ω–µ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç –ø—É—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–≠—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞ [[HTTP]], —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏.

---

## 2Ô∏è‚É£ –ú–µ—Ç–æ–¥ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç

–ï—Å–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:

GET /api/v1/docs

–∞ —Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—à—å:

POST /api/v1/docs

—Ç–æ –±—É–¥–µ—Ç:

- 404
    
- –∏–ª–∏ 405 (Method Not Allowed)
    

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[HTTP Methods]], [[Status Code]]

---

## 3Ô∏è‚É£ Middleware —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –Ω–æ —Ä–æ—É—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω

[[Middleware]] –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –î–û –ø–æ–∏—Å–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞.

–ü–æ—ç—Ç–æ–º—É —Ç—ã –º–æ–∂–µ—à—å –≤–∏–¥–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:

start: GET /api/v1/docs  
end: GET /api/v1/docs

–ù–æ –µ—Å–ª–∏ —Ä–æ—É—Ç –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω ‚Äî –±—É–¥–µ—Ç 404.

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[Logging]], [[Observability]]

---

# üß± Handler –∫–∞–∫ –º–µ—Ç–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–õ—É—á—à–µ –¥–µ–ª–∞—Ç—å –º–µ—Ç–æ–¥—ã:

func (api *API) listUsers(w http.ResponseWriter, r *http.Request) {  
	ctx := r.Context() // [[Context]]  
  
	users, err := api.svc.List(ctx)  
	...  
}

–ü–æ—á–µ–º—É —ç—Ç–æ –ª—É—á—à–µ:

- –Ω–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    
- –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–Ω–µ–¥—Ä—è—é—Ç—Å—è —á–µ—Ä–µ–∑ [[Dependency Injection]]
    
- –ø—Ä–æ—â–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ [[httptest]]
    
- —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç [[Clean Architecture]]
    

---

# üß© Middleware ‚Äî —ç—Ç–æ –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ handler

Middleware ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤–∏–¥–∞:

func(next http.Handler) http.Handler

–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ:

Request  
  ‚Üì  
LoggingMiddleware  
  ‚Üì  
AuthMiddleware  
  ‚Üì  
Handler

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã:

- [[Middleware]]
    
- [[JWT]]
    
- [[Context]]
    
- [[Rate Limiting]]
    
- [[OpenTelemetry]]
    

---

# üîÅ –ü–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞)

1. –ö–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç [[HTTP]] –∑–∞–ø—Ä–æ—Å
    
2. –ó–∞–ø—Ä–æ—Å –ø–æ–ø–∞–¥–∞–µ—Ç –≤ [[Router]]
    
3. [[Middleware]] –æ–±–æ—Ä–∞—á–∏–≤–∞—é—Ç handler
    
4. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è handler
    
5. Handler –≤—ã–∑—ã–≤–∞–µ—Ç [[Service Layer]]
    
6. Service –≤—ã–∑—ã–≤–∞–µ—Ç [[Repository]]
    
7. –û—Ç–≤–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ [[JSON]]
    
8. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É
    

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã:

- [[Serialization]]
    
- [[Clean Architecture]]
    
- [[Dependency Injection]]
    

---

# üö® –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ API

- ‚ùå –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ handler (–Ω–∞—Ä—É—à–µ–Ω–∏–µ [[Clean Architecture]])
    
- ‚ùå –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    
- ‚ùå –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–∏ (`/v1`)
    
- ‚ùå –Ω–µ—Ç –µ–¥–∏–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—à–∏–±–æ–∫ (—Å–º. [[Error Handling]])
    
- ‚ùå —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ API
    
- ‚ùå —Å—Ç—Ä–æ–∫–æ–≤–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –ø—É—Ç–µ–π ‚Üí –¥–≤–æ–π–Ω–æ–π `/`
    
- ‚ùå –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [[Context]] –¥–ª—è –ø—Ä–æ–∫–∏–¥—ã–≤–∞–Ω–∏—è request-scoped –¥–∞–Ω–Ω—ã—Ö
    

---

# üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –º—ã—Å–ª—å

API —Å–ª–æ–π ‚Äî —ç—Ç–æ:

> –ê–¥–∞–ø—Ç–µ—Ä –º–µ–∂–¥—É [[HTTP]] –∏ [[Service Layer]].

–û–Ω:

- –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
    
- –º–∞–ø–ø–∏—Ç –≤ –¥–æ–º–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã
    
- –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç [[JSON]] + [[Status Code]]
    

–û–Ω –ù–ï:

- –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é —Å –ë–î ([[Repository]])
    
- –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª
    
- –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    

---

# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API-—Å–ª–æ—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

- [[httptest]]
    
- unit-—Ç–µ—Å—Ç—ã service –±–µ–∑ HTTP
    
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
    

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[Testing]]

---

# üß≠ –ò—Ç–æ–≥–æ–≤–∞—è –º–æ–¥–µ–ª—å

API =  
[[Router]]

- [[Middleware]]
    
- Handlers
    
- –ú–∞–ø–ø–∏–Ω–≥ DTO ‚Üî Domain
    
- –°–≤—è–∑—å —Å [[Service Layer]]
    

–≠—Ç–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–π —Å–ª–æ–π –≤–Ω—É—Ç—Ä–∏ [[Clean Architecture]].