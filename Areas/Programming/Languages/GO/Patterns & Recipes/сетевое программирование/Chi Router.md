# üåø Chi Router (Go): –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

## –ß—Ç–æ —Ç–∞–∫–æ–µ chi

**chi** ‚Äî —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π HTTP-—Ä–æ—É—Ç–µ—Ä –¥–ª—è Go.

–û–Ω:

- —Ä–∞—Å—à–∏—Ä—è–µ—Ç [[net/HTTP]]
    
- –Ω–µ –ª–æ–º–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É
    
- —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `http.Handler`
    
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç [[Middleware]]
    
- —É–¥–æ–±–µ–Ω –¥–ª—è [[REST API]]
    

–ì–ª–∞–≤–Ω–∞—è –º—ã—Å–ª—å:

> chi ‚Äî —ç—Ç–æ —Ç–æ–Ω–∫–∏–π —Å–ª–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–≤–µ—Ä—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ [[HTTP]].

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[Router]], [[HTTP]], [[Middleware]], [[REST API]]

---

# üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

go get github.com/go-chi/chi/v5

–ò–º–ø–æ—Ä—Ç:

import "github.com/go-chi/chi/v5"

---

# üèó –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä

package main  
  
import (  
	"net/http"  
	"github.com/go-chi/chi/v5"  
)  
  
func main() {  
	r := chi.NewRouter()  
  
	r.Get("/hello", func(w http.ResponseWriter, r *http.Request) {  
		w.Write([]byte("hello"))  
	})  
  
	http.ListenAndServe(":8080", r)  
}

chi —Ä–µ–∞–ª–∏–∑—É–µ—Ç `http.Handler`, –ø–æ—ç—Ç–æ–º—É –µ–≥–æ –º–æ–∂–Ω–æ –Ω–∞–ø—Ä—è–º—É—é –ø–µ—Ä–µ–¥–∞—Ç—å –≤ `ListenAndServe`.

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[HTTP Server]]

---

# üìå –ú–µ—Ç–æ–¥—ã HTTP

–í chi –µ—Å—Ç—å —É–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

r.Get("/users", handler)  
r.Post("/users", handler)  
r.Put("/users/{id}", handler)  
r.Delete("/users/{id}", handler)

–≠—Ç–æ –∏–∑–±–∞–≤–ª—è–µ—Ç –æ—Ç —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

if r.Method != http.MethodGet { ... }

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[HTTP Methods]], [[Status Code]]

---

# üì¶ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏

–í–º–µ—Å—Ç–æ —Ä—É—á–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–æ–∫–∏:

r.Get("/users/{id}", getUser)

–í handler:

func getUser(w http.ResponseWriter, r *http.Request) {  
	id := chi.URLParam(r, "id")  
	w.Write([]byte("user id = " + id))  
}

–≠—Ç–æ —É–¥–æ–±–Ω–µ–µ –∏ —á–∏—â–µ, —á–µ–º –≤—Ä—É—á–Ω—É—é —Ä–∞–∑–±–∏—Ä–∞—Ç—å URL.

---

# üß≠ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (Route)

–û—á–µ–Ω—å –≤–∞–∂–Ω–∞—è —Ñ–∏—á–∞.

r.Route("/api/v1", func(r chi.Router) {  
	r.Route("/users", func(r chi.Router) {  
		r.Get("/", listUsers)  
		r.Post("/", createUser)  
		r.Get("/{id}", getUser)  
	})  
})

–≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

/api/v1/users  
/api/v1/users/{id}

–≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç:

- –ª–æ–≥–∏—á–µ—Å–∫–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å API
    
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
    
- —Ä–∞–∑–¥–µ–ª—è—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç—ã
    

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[Versioning]], [[Public API vs Private API]]

---

# üß© Middleware –≤ chi

Middleware –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑:

r.Use(loggingMiddleware)

Middleware –∏–º–µ–µ—Ç —Å–∏–≥–Ω–∞—Ç—É—Ä—É:

func(next http.Handler) http.Handler

–ü—Ä–∏–º–µ—Ä:

func logging(next http.Handler) http.Handler {  
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {  
		log.Println("start:", r.Method, r.URL.Path)  
		next.ServeHTTP(w, r)  
		log.Println("end:", r.Method, r.URL.Path)  
	})  
}

Middleware –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å:

- –≥–ª–æ–±–∞–ª—å–Ω–æ (`r.Use`)
    
- —Ç–æ–ª—å–∫–æ –∫ –≥—Ä—É–ø–ø–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (`r.Route(...).Use(...)`)
    

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[Middleware]], [[Logging]]

---

# üîê Middleware –¥–ª—è —á–∞—Å—Ç–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤

–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ –∏ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:

r.Route("/api/v1", func(r chi.Router) {  
  
	r.Get("/health", healthHandler) // –ø—É–±–ª–∏—á–Ω—ã–π  
  
	r.Group(func(r chi.Router) {  
		r.Use(authMiddleware)  
  
		r.Get("/users", listUsers)  
		r.Post("/users", createUser)  
	})  
})

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –æ—Ç–¥–µ–ª–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
    
- –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏
    
- —Å–æ–±–ª—é–¥–∞—Ç—å [[Clean Architecture]]
    

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[JWT]], [[Authentication]], [[Authorization]]

---

# üì§ –†–∞–±–æ—Ç–∞ —Å JSON

chi –Ω–µ –Ω–∞–≤—è–∑—ã–≤–∞–µ—Ç —Å–ø–æ—Å–æ–± —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

–û–±—ã—á–Ω–æ:

json.NewEncoder(w).Encode(data)

–ò:

json.NewDecoder(r.Body).Decode(&req)

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[JSON]], [[Serialization]]

---

# ‚ö† –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å chi

### ‚ùå –î–≤–æ–π–Ω–æ–π —Å–ª—ç—à –≤ –ø—É—Ç–∏

`/api//v1/users`  
–∏  
`/api/v1/users` ‚Äî —Ä–∞–∑–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã.

chi –Ω–µ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –ø—É—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[Router]], [[HTTP]]

---

### ‚ùå –ú–µ—Ç–æ–¥ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç

–ï—Å–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:

r.Get("/users", ...)

–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω POST ‚Äî –±—É–¥–µ—Ç 404 –∏–ª–∏ 405.

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[HTTP Methods]], [[Status Code]]

---

### ‚ùå –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

–í—Å–µ –º–∞—Ä—à—Ä—É—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã **–¥–æ**:

http.ListenAndServe(...)

---

# üß† –ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å chi

chi —Ö–æ—Ä–æ—à, –µ—Å–ª–∏:

- —Ç—ã —Ö–æ—á–µ—à—å –º–∏–Ω–∏–º–∞–ª–∏–∑–º
    
- —Ç–µ–±–µ –Ω—Ä–∞–≤–∏—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π [[net/HTTP]]
    
- –Ω–µ –Ω—É–∂–µ–Ω ‚Äú–º–∞–≥–∏—á–µ—Å–∫–∏–π‚Äù —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
    
- —Ç—ã —Å—Ç—Ä–æ–∏—à—å [[REST API]]
    

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω heavy framework ‚Äî –µ—Å—Ç—å [[Gin]], [[Echo]].

–ù–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ chi –±–æ–ª–µ–µ —á–µ–º –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

---

# üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å chi

–ù–∏–∫–∞–∫–æ–π –º–∞–≥–∏–∏ ‚Äî –æ–±—ã—á–Ω—ã–π [[httptest]]:

req := httptest.NewRequest(http.MethodGet, "/users/1", nil)  
rec := httptest.NewRecorder()  
  
r.ServeHTTP(rec, req)

–ü–æ—Å–∫–æ–ª—å–∫—É chi ‚Äî —ç—Ç–æ `http.Handler`, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–µ.

–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–µ–º—ã: [[Testing]], [[httptest]]

---

# üß≠ –ò—Ç–æ–≥–æ–≤–∞—è –º–æ–¥–µ–ª—å

chi =

- –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
    
- –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø—É—Ç–µ–π
    
- –ø–∞—Ä–∞–º–µ—Ç—Ä—ã URL
    
- –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ [[Middleware]]
    
- —É–¥–æ–±–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ [[REST API]]
    

–û–Ω –Ω–µ:

- –Ω–µ ORM
    
- –Ω–µ DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
    
- –Ω–µ –±–∏–∑–Ω–µ—Å-—Å–ª–æ–π
    
- –Ω–µ –º–∞–≥–∏—á–µ—Å–∫–∏–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
    

–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ —É–¥–æ–±–Ω—ã–π [[Router]].