# üìù Logging (–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ) –≤ Go

Logging ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å **–∑–∞–ø–∏—Å–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–±–æ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**.

–ü—Ä–æ—â–µ:

> –õ–æ–≥–∏ ‚Äî —ç—Ç–æ –∏—Å—Ç–æ—Ä–∏—è —Ç–æ–≥–æ, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –≤ —Ç–≤–æ—ë–º —Å–µ—Ä–≤–µ—Ä–µ.

–°–≤—è–∑–∞–Ω–æ —Å:

- [[Middleware]]
    
- [[HTTP]]
    
- [[API]]
    
- [[REST API]]
    
- [[Chi Router]]
    
- [[Status Code]]
    

---

# üß† –ó–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ –ø–æ–º–æ–≥–∞—é—Ç:

- –ø–æ–Ω—è—Ç—å, –∫—Ç–æ —Å–¥–µ–ª–∞–ª –∑–∞–ø—Ä–æ—Å
    
- —É–≤–∏–¥–µ—Ç—å –æ—à–∏–±–∫–∏
    
- –æ—Ç–ª–∞–¥–∏—Ç—å –±–∞–≥
    
- –Ω–∞–π—Ç–∏ –ø—Ä–∏—á–∏–Ω—É –ø–∞–¥–µ–Ω–∏—è
    
- –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É
    

–ë–µ–∑ –ª–æ–≥–æ–≤ backend –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ "—á—ë—Ä–Ω—ã–π —è—â–∏–∫".

---

# üîÑ –ö–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ

–ö–æ–≥–¥–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç HTTP-–∑–∞–ø—Ä–æ—Å:

1. –ö–ª–∏–µ–Ω—Ç –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
    
2. –û–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ [[Middleware]]
    
3. Middleware –ª–æ–≥–∏—Ä—É–µ—Ç:
    
    - –º–µ—Ç–æ–¥
        
    - –ø—É—Ç—å
        
    - —Å—Ç–∞—Ç—É—Å –∫–æ–¥
        
    - –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        
4. –ó–∞–ø—Ä–æ—Å –∏–¥—ë—Ç –≤ [[HTTP Handlers]]
    

–°—Ö–µ–º–∞:

Client ‚Üí Logging Middleware ‚Üí Auth Middleware ‚Üí Handler ‚Üí Response

---

# üì¶ –ß—Ç–æ –æ–±—ã—á–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä:

- HTTP –º–µ—Ç–æ–¥ (GET, POST)
    
- URL
    
- Status Code
    
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    
- IP –∫–ª–∏–µ–Ω—Ç–∞
    

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å:

- user_id
    
- trace_id
    
- request_id
    
- —Ç–µ–ª–æ –æ—à–∏–±–∫–∏
    

---

# üöÄ Logging –≤ Go (–±–∞–∑–∞)

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞–∫–µ—Ç:

import "log"

–ü—Ä–∏–º–µ—Ä:

log.Println("Server started")  
log.Printf("User %d logged in", userID)

–ù–æ –¥–ª—è API —ç—Ç–æ–≥–æ –º–∞–ª–æ.

---

# üî• –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Middleware

–í–æ—Ç –±–∞–∑–æ–≤—ã–π logging middleware:

func LoggingMiddleware(next http.Handler) http.Handler {  
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {  
		start := time.Now()  
  
		log.Printf("Started %s %s", r.Method, r.URL.Path)  
  
		next.ServeHTTP(w, r)  
  
		log.Printf("Completed in %v", time.Since(start))  
	})  
}

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å:

- [[Router]]
    
- [[Chi Router]]
    
- [[HTTP Handlers]]
    

---

# üß† –ü—Ä–æ–±–ª–µ–º–∞: —Å—Ç–∞—Ç—É—Å –∫–æ–¥ –Ω–µ –≤–∏–¥–Ω–æ

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `http.ResponseWriter` –Ω–µ –¥–∞—ë—Ç —Å—Ç–∞—Ç—É—Å –∫–æ–¥.

–ü–æ—ç—Ç–æ–º—É –¥–µ–ª–∞—é—Ç –æ–±—ë—Ä—Ç–∫—É:

type statusWriter struct {  
	http.ResponseWriter  
	status int  
}  
  
func (w *statusWriter) WriteHeader(code int) {  
	w.status = code  
	w.ResponseWriter.WriteHeader(code)  
}

–ò –∏—Å–ø–æ–ª—å–∑—É–µ–º:

func LoggingMiddleware(next http.Handler) http.Handler {  
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {  
		start := time.Now()  
  
		sw := &statusWriter{ResponseWriter: w, status: 200}  
  
		next.ServeHTTP(sw, r)  
  
		log.Printf(  
			"%s %s %d %v",  
			r.Method,  
			r.URL.Path,  
			sw.status,  
			time.Since(start),  
		)  
	})  
}

–¢–µ–ø–µ—Ä—å –ª–æ–≥ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º.

---

# üìä –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∞

GET /api/users 200 12ms  
POST /login 401 3ms

---

# üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í –ø—Ä–æ–¥–µ –ø–æ—á—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ—Å—Ç–æ `log.Println`.

–ò—Å–ø–æ–ª—å–∑—É—é—Ç:

- logrus
    
- zap
    
- zerolog
    

–ü–æ—á–µ–º—É?

–ü–æ—Ç–æ–º—É —á—Ç–æ –Ω—É–∂–Ω–æ JSON-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

{  
  "level": "info",  
  "method": "GET",  
  "path": "/users",  
  "status": 200,  
  "duration": "12ms"  
}

–≠—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è:

- Grafana
    
- ELK
    
- Loki
    

---

# üìå –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–æ–≤

–û–±—ã—á–Ω–æ –µ—Å—Ç—å:

- DEBUG
    
- INFO
    
- WARN
    
- ERROR
    
- FATAL
    

–ü—Ä–∏–º–µ—Ä:

logger.Info("server started")  
logger.Error("db connection failed")

---

# ‚ö†Ô∏è –ß—Ç–æ –Ω–µ–ª—å–∑—è –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å

‚ùå –ü–∞—Ä–æ–ª–∏  
‚ùå JWT —Ç–æ–∫–µ–Ω—ã  
‚ùå Cookie  
‚ùå –°–µ–∫—Ä–µ—Ç—ã

–°–≤—è–∑–∞–Ω–æ —Å:

- [[JWT]]
    
- [[Cookies]]
    
- [[HTTPS]]
    

---

# üß† –ì–¥–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è

–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ:

- –í [[Middleware]] ‚Äî –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
    
- –í –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ ‚Äî –¥–ª—è –æ—à–∏–±–æ–∫
    
- –í –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ ‚Äî –¥–ª—è –±–∞–∑—ã/–∫—ç—à–∞
    

–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:

- –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–∞–∂–¥–æ–º handler –≤—Ä—É—á–Ω—É—é
    

---

# üìä –ü–ª—é—Å—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

‚úÖ –£–ø—Ä–æ—â–∞–µ—Ç –æ—Ç–ª–∞–¥–∫—É  
‚úÖ –í–∏–¥–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∞  
‚úÖ –í–∏–¥–Ω–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
‚úÖ –ü–æ–º–æ–≥–∞–µ—Ç –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

---

# ‚ùå –ú–∏–Ω—É—Å—ã (–µ—Å–ª–∏ –¥–µ–ª–∞—Ç—å –ø–ª–æ—Ö–æ)

‚ùå –ó–∞—Ö–ª–∞–º–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤  
‚ùå –ü–æ—Ç–µ—Ä—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
‚ùå –£—Ç–µ—á–∫–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

# üéØ –ò—Ç–æ–≥

Logging ‚Äî —ç—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å backend.

–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –≤ Go:

Router  
   ‚Üì  
Logging Middleware  
   ‚Üì  
Auth Middleware  
   ‚Üì  
Handler

–ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –≤ —Ç–≤–æ—ë–º –≥—Ä–∞—Ñ–µ –æ–Ω —Å–≤—è–∑–∞–Ω —Å:

- [[Middleware]]
    
- [[Chi Router]]
    
- [[API]]
    
- [[REST API]]